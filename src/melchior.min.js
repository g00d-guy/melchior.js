/*! melchiorjs - v0.0.2-alpha (https://github.com/voronianski/melchior.js) */
!function(a){"use strict";function b(){return document.getElementsByTagName("script")}function c(a,b){if(a)for(var c=0,d=a.length;d>c;c++)a[c]&&b(a[c],c,a)}function d(a,b){if(a)for(var c=a.length;c--&&(!a[c]||!b(a[c],c,a)););}function e(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function f(a,b){var c;for(c in a)if(e(a,c)&&b(a[c],c))break}function g(a){this.path=a,this._depTable={},this._depLength=0,this._loaded=!1,l._moduleTable[a]=this}var h={},i=document.getElementsByTagName("head")[0],j=/(?:\/\*(?:[\s\S]*?)\*\/)|(?:^\s*\/\/(?:.*)$)/gm,k=document.getElementsByTagName("base")[0];k&&(i=k.parentNode),d(b(),function(a){var b=a.getAttribute("data-main");return b?(h.deps=[b],!0):void 0});var l=a.melchiorjs=function(a){return a.deps&&l._injectMain(h.deps[0]),h.paths=a.paths,h.paths&&f(h.paths,function(a,b){l.load(a,function(a){var c="";a.content=a.content.replace(j,""),c+=a.content.match(/(melchiorjs)/g)?a.content:[a.content,';melchiorjs.module("',b,'").body(function () {'," return ",b,";});"].join(""),l._injectScript(c)})}),l};l.config=function(a){return l(a)},l._createScript=function(){var a=document.createElement("script");return a.type="text/javascript",a.charset="utf-8",a.defer=!0,a.async=!0,a},l._injectMain=function(a){var b,c=this._createScript();c.onload=c.onerror=c.onreadystatechange=function(){c.readyState&&!/^c|loade/.test(c.readyState)||b||(c.onload=c.onreadystatechange=null,b=!0)},c.src=a,this._appendScript(c)},l._injectScript=function(a){var b=this._createScript();b.text=a,this._appendScript(b)},l._appendScript=function(a){k?i.insertBefore(a,k):i.appendChild(a)},l.load=function(a,b){var c=new XMLHttpRequest;c.open("GET",a),c.onreadystatechange=function(){4===c.readyState&&(200===c.status?b({content:c.responseText,type:c.getResponseHeader("content-type")}):new Error(c.statusText))},c.send()},l._events={},l.on=function(a,b){var c=this._events[a];c||(c=this._events[a]=[]),c.push(b)},l.emit=function(a,b){c(this._events[a],function(a){a(b)})},l._moduleTable={},l.module=function(a){return new g(a)},l._getModuleInstance=function(a){if(a)if(l._moduleTable[a]){if(l._moduleTable[a]._loaded)return console.log("--- boom",a,l._moduleTable,l._moduleTable[a]),l._moduleTable[a]._instance;console.log("--- not loaded",a,l._moduleTable)}else console.log("--- not registered",a);else console.log("--- no path provided",a)},l._checkDependenciesResolved=function(a){for(var b in a._depTable){var c=l._moduleTable[b];if(!c||!c._loaded)return!1}return a._loaded=!0,l.emit("ready",a),!0},l._refreshModuleState=function(){var a=!1;f(l._moduleTable,function(b){b._loaded||(a=a||l._checkDependenciesResolved(b))}),a&&l._refreshModuleState()},g.prototype={require:function(a,b){return this._depTable[a]={alias:b},this._depLength++,this},run:function(a){a&&(this._body=a),this._run()},body:function(a){this._body=a,0===this._depLength&&(this._loaded=!0,l.emit("ready",this)),this._run()},_run:function(){var a=this;l._refreshModuleState(),a._loaded?a._exec():l.on("ready",function(b){b.path===a.path&&setTimeout(function(){a._exec()},0)})},_exec:function(){var b=this,d=[];for(var e in b._depTable){var f=l._getModuleInstance(e);if(!f)return!1;var g=b._depTable[e].alias||e;d.push({varName:g,instance:f})}var h=function(){var a=this;return c(d,function(b){a[b.varName]=b.instance}),b._body()};b._instance=h.call(a)}},l(h)}(this);